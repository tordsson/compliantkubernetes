
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Compliant Kubernetes is a Kubernetes distribution that reduces the burden for complying with Swedish Healthcare (Patientdatalagen), GDPR and ISO 27001.">
      
      
      
        <meta name="author" content="Elastisys AB">
      
      
        <link rel="canonical" href="https://compliantkubernetes.io/operator-manual/ovh-managed-kubernetes/">
      
      <link rel="icon" href="../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>On OVH Managed Kubernetes - Compliant Kubernetes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
    
    
    
    
<!-- Matomo -->
<script>var _paq = window._paq = window._paq || [];
_paq.push(['disableCookies']);
_paq.push(['trackAllContentImpressions']);_paq.push(['trackPageView']);_paq.push(['enableLinkTracking']);_paq.push(['alwaysUseSendBeacon']);_paq.push(['setTrackerUrl', "\/\/elastisys.com\/wp-content\/plugins\/matomo\/app\/matomo.php"]);_paq.push(['setSiteId', '2']);var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
g.type='text/javascript'; g.async=true; g.src="\/\/elastisys.com\/wp-content\/uploads\/matomo\/matomo.js"; s.parentNode.insertBefore(g,s);
</script>
<!-- End Matomo Code -->

    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#compliant-kubernetes-deployment-on-ovh-managed-kubernetes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Compliant Kubernetes" class="md-header__button md-logo" aria-label="Compliant Kubernetes" data-md-component="logo">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Compliant Kubernetes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              On OVH Managed Kubernetes
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/elastisys/compliantkubernetes/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Compliant Kubernetes" class="md-nav__button md-logo" aria-label="Compliant Kubernetes" data-md-component="logo">
      
  <img src="../../img/logo.png" alt="logo">

    </a>
    Compliant Kubernetes
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/elastisys/compliantkubernetes/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../compliance/" class="md-nav__link">
        Compliance Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          User Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="User Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          User Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/setup/" class="md-nav__link">
        Set up
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/registry/" class="md-nav__link">
        Container registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/kubernetes-api/" class="md-nav__link">
        Kubernetes API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/logs/" class="md-nav__link">
        Logs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/metrics/" class="md-nav__link">
        Metrics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/alerts/" class="md-nav__link">
        Alerts
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/backup/" class="md-nav__link">
        Backups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/ci-cd/" class="md-nav__link">
        CI/CD
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/safeguards/" class="md-nav__link">
        Safeguards
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/demarcation/" class="md-nav__link">
        Can I?
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          CISO Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="CISO Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          CISO Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/backup/" class="md-nav__link">
        Backup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/cryptography/" class="md-nav__link">
        Cryptography
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/intrusion-detection/" class="md-nav__link">
        Intrusion Detection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/policy-as-code/" class="md-nav__link">
        Policy-as-Code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/network-security/" class="md-nav__link">
        Network Security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/kubernetes-status/" class="md-nav__link">
        Kubernetes Status
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/vulnerability/" class="md-nav__link">
        Vulnerability Management
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ciso-guide/log-review/" class="md-nav__link">
        Log Review
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Administrator Manual
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Administrator Manual" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Administrator Manual
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          Creating/Destroying/Upgrading a Cluster
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Creating/Destroying/Upgrading a Cluster" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Creating/Destroying/Upgrading a Cluster
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aws/" class="md-nav__link">
        On AWS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../azure/" class="md-nav__link">
        On Azure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../exoscale/" class="md-nav__link">
        On Exoscale
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../gcp/" class="md-nav__link">
        On GCP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../openstack/" class="md-nav__link">
        On Openstack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../safespring/" class="md-nav__link">
        On Safespring
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          On OVH Managed Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        On OVH Managed Kubernetes
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../eksd/" class="md-nav__link">
        On EKS-D
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../clean-up/" class="md-nav__link">
        Remove Compliant Kubernetes Apps
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../qa/" class="md-nav__link">
        QA
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_5" type="checkbox" id="__nav_6_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_5">
          Configuring a Cluster
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Configuring a Cluster" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_5">
          <span class="md-nav__icon md-icon"></span>
          Configuring a Cluster
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cluster-sizing/" class="md-nav__link">
        Sizing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ingress/" class="md-nav__link">
        Ingress
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../access-control/" class="md-nav__link">
        Access Control
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../user-alerts/" class="md-nav__link">
        User Alerts
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../disaster-recovery/" class="md-nav__link">
        Disaster Recovery
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../break-glass/" class="md-nav__link">
        Breaking the Glass
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../credentials/" class="md-nav__link">
        Use of Credentials
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Contributor Guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Contributor Guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Contributor Guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contributor-guide/" class="md-nav__link">
        Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/" class="md-nav__link">
        Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../adr/" class="md-nav__link">
        Architectural Decision Log
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tech-radar/" class="md-nav__link">
        Tech Radar
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../vocabulary/" class="md-nav__link">
        Vocabulary
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        FAQ
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../release-notes/" class="md-nav__link">
        Release Notes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://elastisys.com/" class="md-nav__link">
        Support ⧉
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://elastisys.com/blog/" class="md-nav__link">
        Blog ⧉
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/elastisys/compliantkubernetes/edit/main/docs/operator-manual/ovh-managed-kubernetes.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <div class="admonition bug">
<p class="admonition-title">This page is out of date</p>
<p>We are currently working on internal documentation to streamline
Compliant Kubernetes onboarding for selected cloud providers. Until
those documents are ready, and until we have capacity to make parts of
that documentation public, this page is out-of-date.</p>
<p>Nevertheless, parts of it are useful. Use at your own risk and don't expect things to work smoothly.</p>
</div>
<!--out-of-date-end-->

<h1 id="compliant-kubernetes-deployment-on-ovh-managed-kubernetes">Compliant Kubernetes Deployment on OVH Managed Kubernetes<a class="headerlink" href="#compliant-kubernetes-deployment-on-ovh-managed-kubernetes" title="Permanent link">&para;</a></h1>
<p>This document contains instructions on how to setup a service cluster and a workload cluster in <a href="https://www.ovh.com">OVH</a>.
The following are the main tasks addressed in this document:</p>
<ol>
<li>Setting up Compliant Kubernetes for OVH Managed Kubernetes</li>
<li>Deploying Compliant Kubernetes on top of two Kubernetes clusters.</li>
</ol>
<p>The instructions below are just samples, you need to update them according to your requirements.</p>
<p>Before starting, make sure you have <a href="../getting-started/">all necessary tools</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This guide is written for compliantkubernetes-apps <a href="https://github.com/elastisys/compliantkubernetes-apps/tree/v0.13.0">v0.13.0</a></p>
</div>
<h2 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">&para;</a></h2>
<p>Create two Kubernetes clusters in OVH, follow <a href="https://docs.ovh.com/gb/en/kubernetes/creating-a-cluster/">this guide</a>.</p>
<div class="admonition note">
<p class="admonition-title">Sizing hint</p>
<p>For the service cluster you can start with creating 3 nodes of size <code>B2-7</code> and add a <code>B2-15</code> node.</p>
<p>The workload cluster is fine with 3 <code>B2-7</code> nodes.</p>
</div>
<h3 id="configure-compliant-kubernetes">Configure Compliant Kubernetes<a class="headerlink" href="#configure-compliant-kubernetes" title="Permanent link">&para;</a></h3>
<p>Start by preparing your shell with some variables that will be used.</p>
<div class="highlight"><pre><span></span><code>REGION=&quot;waw&quot; # Region for the cluster
ISSUER_MAIL=&quot;user@example.com&quot; # Mail that will be used for the LetsEncrypt certificate issuer

export CK8S_CONFIG_PATH=~/.ck8s/my-ovh-cluster # Path for the configuration
export CK8S_ENVIRONMENT_NAME=my-ovh-cluster # Name of the environment
export CK8S_PGP_FP=&quot;FOOBAR1234567&quot; # Fingerprint of your PGP key, retrieve with gpg --list-secret-keys
export CK8S_CLOUD_PROVIDER=baremetal # We don&#39;t have a OVH flavor, but baremetal is fine
export CK8S_FLAVOR=dev # Change to &quot;prod&quot; if it&#39;s a production cluster you&#39;re setting up

S3_ACCESS_KEY=&quot;foo&quot; # Access key for S3, see https://docs.ovh.com/gb/en/public-cloud/getting_started_with_the_swift_S3_API/#create-ec2-credentials
S3_SECRET_KEY=&quot;bar&quot; # Secret key for S3
</code></pre></div>
<p>Download the kubeconfig and set them up for Compliant Kubernetes by following these steps:</p>
<h3 id="create-the-path-where-theyre-going-to-be-stored">Create the path where they're going to be stored<a class="headerlink" href="#create-the-path-where-theyre-going-to-be-stored" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>mkdir -p &quot;${CK8S_CONFIG_PATH}/.state&quot;
</code></pre></div>
<h3 id="download-the-kubeconfig-from-ovh-for-the-service-cluster-and-run">Download the kubeconfig from OVH for the service cluster and run:<a class="headerlink" href="#download-the-kubeconfig-from-ovh-for-the-service-cluster-and-run" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>mv ~/Downloads/kubeconfig.yml &quot;${CK8S_CONFIG_PATH}/.state/kube_config_sc.yaml&quot;
sops --encrypt --in-place --pgp &quot;${CK8S_PGP_FP}&quot; &quot;${CK8S_CONFIG_PATH}/.state/kube_config_sc.yaml&quot;
</code></pre></div>
<h3 id="download-the-kubeconfig-from-ovh-for-the-workload-cluster-and-run">Download the kubeconfig from OVH for the workload cluster and run:<a class="headerlink" href="#download-the-kubeconfig-from-ovh-for-the-workload-cluster-and-run" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>mv ~/Downloads/kubeconfig.yml &quot;${CK8S_CONFIG_PATH}/.state/kube_config_wc.yaml&quot;
sops --encrypt --in-place --pgp &quot;${CK8S_PGP_FP}&quot; &quot;${CK8S_CONFIG_PATH}/.state/kube_config_wc.yaml&quot;
</code></pre></div>
<h3 id="prepare-dns-records">Prepare DNS records<a class="headerlink" href="#prepare-dns-records" title="Permanent link">&para;</a></h3>
<p>Set up DNS records in OVH.</p>
<p>Run this snippet and append it into "Change in text format" in your domain in OVH.</p>
<div class="highlight"><pre><span></span><code>IP=&quot;203.0.113.123&quot;

cat &lt;&lt;EOF | envsubst
*.ops.${CK8S_ENVIRONMENT_NAME} 60 IN A ${IP}
*.${CK8S_ENVIRONMENT_NAME} 60 IN A ${IP}
grafana.${CK8S_ENVIRONMENT_NAME} 60 IN A ${IP}
harbor.${CK8S_ENVIRONMENT_NAME} 60 IN A ${IP}
kibana.${CK8S_ENVIRONMENT_NAME} 60 IN A ${IP}
dex.${CK8S_ENVIRONMENT_NAME} 60 IN A ${IP}
notary.harbor.${CK8S_ENVIRONMENT_NAME} 60 IN A ${IP}
EOF
</code></pre></div>
<p>Since we don't know the IP for the loadbalancer yet, you can set them to <code>203.0.113.123</code> <em>(TEST-NET-3)</em>.</p>
<p>Create required buckets that Compliant Kubernetes will use.</p>
<div class="highlight"><pre><span></span><code>cat &lt;&lt;EOF | sops --encrypt --pgp &quot;${CK8S_PGP_FP}&quot; --output-type ini --input-type ini /dev/stdin &gt; s3cmd.ini
[default]
use_https   = True
host_base   = s3.${REGION}.cloud.ovh.net
host_bucket = s3.${REGION}.cloud.ovh.net
access_key  = ${S3_ACCESS_KEY}
secret_key  = ${S3_SECRET_KEY}
EOF

sops exec-file --no-fifo s3cfg.ini &quot;s3cmd --config {} mb s3://${CK8S_ENVIRONMENT_NAME}-harbor&quot;
sops exec-file --no-fifo s3cfg.ini &quot;s3cmd --config {} mb s3://${CK8S_ENVIRONMENT_NAME}-velero&quot;
sops exec-file --no-fifo s3cfg.ini &quot;s3cmd --config {} mb s3://${CK8S_ENVIRONMENT_NAME}-es-backup&quot;
sops exec-file --no-fifo s3cfg.ini &quot;s3cmd --config {} mb s3://${CK8S_ENVIRONMENT_NAME}-influxdb&quot;
sops exec-file --no-fifo s3cfg.ini &quot;s3cmd --config {} mb s3://${CK8S_ENVIRONMENT_NAME}-sc-logs&quot;
</code></pre></div>
<p>Download Compliant Kubernetes and checkout the latest version.</p>
<div class="highlight"><pre><span></span><code>git clone git@github.com:elastisys/compliantkubernetes-apps.git
cd compliantkubernetes-apps
git checkout v0.13.0
</code></pre></div>
<p>Initialize the config.</p>
<div class="highlight"><pre><span></span><code>bin/ck8s init
</code></pre></div>
<p>Update the service cluster configuration for OVH</p>
<div class="highlight"><pre><span></span><code>yq write --inplace sc-config.yaml global.baseDomain &quot;${CK8S_ENVIRONMENT_NAME}.${DOMAIN}&quot;
yq write --inplace sc-config.yaml global.opsDomain &quot;ops.${CK8S_ENVIRONMENT_NAME}.${DOMAIN}&quot;
yq write --inplace sc-config.yaml global.issuer &quot;letsencrypt-prod&quot;

yq write --inplace sc-config.yaml storageClasses.default &quot;csi-cinder-high-speed&quot;
yq write --inplace sc-config.yaml storageClasses.local.enabled &quot;false&quot;

yq write --inplace sc-config.yaml objectStorage.s3.region &quot;${REGION}&quot;
yq write --inplace sc-config.yaml objectStorage.s3.regionEndpoint &quot;https://s3.${REGION}.cloud.ovh.net/&quot;

yq write --inplace sc-config.yaml fluentd.forwarder.useRegionEndpoint &quot;false&quot;

yq write --inplace sc-config.yaml nfsProvisioner.server &quot;not-used&quot;

yq write --inplace sc-config.yaml ingressNginx.controller.useHostPort &quot;false&quot;
yq write --inplace sc-config.yaml ingressNginx.controller.service.enabled &quot;true&quot;
yq write --inplace sc-config.yaml ingressNginx.controller.service.type &quot;LoadBalancer&quot;
yq write --inplace sc-config.yaml ingressNginx.controller.service.annotations &quot;&quot;

yq write --inplace sc-config.yaml issuers.letsencrypt.prod.email &quot;${ISSUER_MAIL}&quot;
yq write --inplace sc-config.yaml issuers.letsencrypt.staging.email &quot;${ISSUER_MAIL}&quot;

yq write --inplace sc-config.yaml metricsServer.enabled &quot;false&quot;
</code></pre></div>
<p>Update the workload cluster configuration for OVH</p>
<div class="highlight"><pre><span></span><code>yq write --inplace wc-config.yaml global.baseDomain &quot;${CK8S_ENVIRONMENT_NAME}.${DOMAIN}&quot;
yq write --inplace wc-config.yaml global.opsDomain &quot;ops.${CK8S_ENVIRONMENT_NAME}.${DOMAIN}&quot;
yq write --inplace wc-config.yaml global.issuer &quot;letsencrypt-prod&quot;

yq write --inplace wc-config.yaml storageClasses.default &quot;csi-cinder-high-speed&quot;
yq write --inplace wc-config.yaml storageClasses.local.enabled &quot;false&quot;

yq write --inplace wc-config.yaml objectStorage.s3.region &quot;${REGION}&quot;
yq write --inplace wc-config.yaml objectStorage.s3.regionEndpoint &quot;https://s3.${REGION}.cloud.ovh.net/&quot;

yq write --inplace wc-config.yaml ingressNginx.controller.useHostPort &quot;false&quot;
yq write --inplace wc-config.yaml ingressNginx.controller.service.enabled &quot;true&quot;
yq write --inplace wc-config.yaml ingressNginx.controller.service.type &quot;LoadBalancer&quot;
yq write --inplace wc-config.yaml ingressNginx.controller.service.annotations &quot;&quot;

yq write --inplace wc-config.yaml metricsServer.enabled &quot;false&quot;
</code></pre></div>
<p>Set s3 credentials</p>
<div class="highlight"><pre><span></span><code>sops --set &#39;[&quot;objectStorage&quot;][&quot;s3&quot;][&quot;accessKey&quot;] &quot;&#39;&quot;${S3_ACCESS_KEY}&quot;&#39;&quot;&#39; secrets.yaml
sops --set &#39;[&quot;objectStorage&quot;][&quot;s3&quot;][&quot;secretKey&quot;] &quot;&#39;&quot;${S3_SECRET_KEY}&quot;&#39;&quot;&#39; secrets.yaml
</code></pre></div>
<h3 id="deploy-compliant-kubernetes">Deploy Compliant Kubernetes<a class="headerlink" href="#deploy-compliant-kubernetes" title="Permanent link">&para;</a></h3>
<p>Now you're ready to deploy Compliant Kubernetes.
When the apply command is done, fetch the external IP assigned to the loadbalancer service and update the DNS record to match this.</p>
<div class="highlight"><pre><span></span><code>bin/ck8s apply sc

bin/ck8s ops kubectl sc get svc -n ingress-nginx ingress-nginx-controller
</code></pre></div>
<p>Run this snippet and update the DNS records you added previously to match the external IP of the service cluster load balancer.</p>
<div class="highlight"><pre><span></span><code>IP=&quot;SERVICE_CLUSTER_LB_IP&quot;

cat &lt;&lt;EOF | envsubst
*.ops.${CK8S_ENVIRONMENT_NAME} IN A ${IP}
grafana.${CK8S_ENVIRONMENT_NAME} IN A ${IP}
harbor.${CK8S_ENVIRONMENT_NAME} IN A ${IP}
kibana.${CK8S_ENVIRONMENT_NAME} IN A ${IP}
dex.${CK8S_ENVIRONMENT_NAME} IN A ${IP}
notary.harbor.${CK8S_ENVIRONMENT_NAME} IN A ${IP}
EOF
</code></pre></div>
<p>Next, do the same for the workload cluster.</p>
<div class="highlight"><pre><span></span><code>bin/ck8s apply wc

bin/ck8s ops kubectl wc get svc -n ingress-nginx ingress-nginx-controller
</code></pre></div>
<p>Run this snippet and update the DNS records you added previously to match the external IP of the workload cluster load balancer.</p>
<div class="highlight"><pre><span></span><code>IP=&quot;WORKLOAD_CLUSTER_LB_IP&quot;

cat &lt;&lt;EOF | envsubst
*.${CK8S_ENVIRONMENT_NAME} IN A ${IP}
EOF
</code></pre></div>
<h3 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permanent link">&para;</a></h3>
<p>At the time of writing, there's some issues with velero and fluentd.</p>
<p>Workarounds for making this work until fix is out</p>
<h3 id="add-s3_endpoint-to-fluentd-fixed-with-this-issue">Add <code>s3_endpoint</code> to fluentd, <em>fixed with <a href="https://github.com/elastisys/compliantkubernetes-apps/issues/282">this issue</a></em><a class="headerlink" href="#add-s3_endpoint-to-fluentd-fixed-with-this-issue" title="Permanent link">&para;</a></h3>
<p>To add this, you need to edit the config map fluentd uses.
Find the <code>&lt;match **&gt;</code> tag and add <code>s3_endpoint https://s3.REGION.cloud.ovh.net/</code>
Where <code>REGION</code> matches what region you're using (<code>waw</code> in the example).</p>
<p>After that, delete the fluentd pod to force it to reload the configuration.</p>
<div class="highlight"><pre><span></span><code>$ bin/ck8s ops kubectl sc edit cm -n fluentd fluentd-aggregator-configmap

    .
    .
    .
    &lt;match **&gt;
      @id output-s3
      @type s3

      aws_key_id &quot;#{ENV[&#39;AWS_ACCESS_KEY_ID&#39;]}&quot;
      aws_sec_key &quot;#{ENV[&#39;AWS_ACCESS_SECRET_KEY&#39;]}&quot;
      s3_endpoint https://s3.waw.cloud.ovh.net/ # &lt;--- Add this line
      s3_region waw
    .
    .
$ bin/ck8s ops kubectl sc delete pod -n fluentd fluentd-0
</code></pre></div>
<h3 id="update-velero-to-use-130-instead-of-120-fixed-with-this-issue">Update velero to use 1.3.0 instead of 1.2.0, <em>fixed with <a href="https://github.com/elastisys/compliantkubernetes-apps/issues/289">this issue</a></em><a class="headerlink" href="#update-velero-to-use-130-instead-of-120-fixed-with-this-issue" title="Permanent link">&para;</a></h3>
<p>For velero to work with OVH S3, velero needs to run with version <code>1.3.0</code>.</p>
<div class="highlight"><pre><span></span><code>bin/ck8s ops kubectl sc patch deployment -n velero velero -p &#39;{&quot;spec&quot;:{&quot;template&quot;:{&quot;spec&quot;:{&quot;containers&quot;:[{&quot;name&quot;:&quot;velero&quot;,&quot;image&quot;:&quot;velero/velero:v1.3.0&quot;}]}}}}&#39;
bin/ck8s ops kubectl sc patch daemonset -n velero restic -p &#39;{&quot;spec&quot;:{&quot;template&quot;:{&quot;spec&quot;:{&quot;containers&quot;:[{&quot;name&quot;:&quot;velero&quot;,&quot;image&quot;:&quot;velero/velero:v1.3.0&quot;}]}}}}&#39;

bin/ck8s ops kubectl wc patch deployment -n velero velero -p &#39;{&quot;spec&quot;:{&quot;template&quot;:{&quot;spec&quot;:{&quot;containers&quot;:[{&quot;name&quot;:&quot;velero&quot;,&quot;image&quot;:&quot;velero/velero:v1.3.0&quot;}]}}}}&#39;
bin/ck8s ops kubectl wc patch daemonset -n velero restic -p &#39;{&quot;spec&quot;:{&quot;template&quot;:{&quot;spec&quot;:{&quot;containers&quot;:[{&quot;name&quot;:&quot;velero&quot;,&quot;image&quot;:&quot;velero/velero:v1.3.0&quot;}]}}}}&#39;
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../safespring/" class="md-footer__link md-footer__link--prev" aria-label="Previous: On Safespring" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              On Safespring
            </div>
          </div>
        </a>
      
      
        
        <a href="../eksd/" class="md-footer__link md-footer__link--next" aria-label="Next: On EKS-D" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              On EKS-D
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright © 2020 Elastisys AB
          </div>
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.b1047164.min.js"></script>
      
    
  </body>
</html>